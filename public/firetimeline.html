<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>MaePing National Park Personal Assistant</title>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
    <!-- Google Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
    <!-- Bootstrap core CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- Material Design Bootstrap -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" rel="stylesheet">

    <!-- JQuery -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- Bootstrap tooltips -->
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
    <!-- Bootstrap core JavaScript -->
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/js/bootstrap.min.js"></script>
    <!-- MDB core JavaScript -->
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js"></script>

    <link rel='stylesheet' type="text/css" href='/index.css'>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>

    <style>

    </style>

    <script type = "module">
        import { LatLon } from 'https://cdn.jsdelivr.net/npm/geodesy@2/utm.js'

        function convertCoordinates(lat, long) {
            let latLongP = new LatLon(lat, long)
            let utmCoord = latLongP.toUtm()

            return utmCoord.toString()
        }

        console.log(convertCoordinates(15,100))

    </script>

    <!-- Google Maps Scripting -->
    <script>

        let map;

        function initMap() {
            map = new google.maps.Map(document.getElementById("map"), {
                center: {lat: 15.0, lng: 100.0},
                zoom: 7,
            });

            const icons =  {
                day: {
                    icon: "dayfire.png",
                },
                night: {
                    icon: "nightfire.png",
                },
            };

            const markersOnMap = [
                {
                    LatLng: [{lat: 15.3636, lng: 100.18719}],
                    Date: "Date of Fire: 2021-03-08",
                    timeOfDay: "Time of Day: Day - 06:48",
                    dayOrNight: "Day or Night: D",
                    type: "day",
                },
                {
                    LatLng: [{lat: 16.97671, lng: 97.2366}],
                    Date: "Date of Fire: 2021-03-08",
                    timeOfDay: "Time of Day: Day - 06:54",
                    dayOrNight: "Day or Night: N",
                    type: "night",
                },
                {
                    LatLng: [{lat: 17.25048, lng: 98.51827}],
                    Date: "Date of Fire: 2021-03-08",
                    timeOfDay: "Time of Day: Day - 06:54",
                    dayOrNight: "Day or Night: D",
                    type: "day",
                },
                {
                    LatLng: [{lat: 17.91273, lng: 97.2955}],
                    Date: "2021-03-08",
                    timeOfDay: "06:54",
                    dayOrNight: "N",
                    type: "night",
                },
            ];

            //Create Markers
            for(let i = 0; i < markersOnMap.length; i++) {

                let parsedCoordinates = JSON.parse(JSON.stringify(markersOnMap[i].LatLng[0]))

                //console.log(test["lat"])
                //console.log(test["lng"])
                //console.log(convertCoordinates(parsedCoordinates["lat"], parsedCoordinates["lng"]))

                let coords = "<p><b> Latitude: </b>" + parsedCoordinates["lat"] + "<b> Longitude: </b>" + parsedCoordinates["lng"] + "</p>"
                let date = "<p><b>Date of Fire: </b>" + markersOnMap[i].Date + "</p>"
                let time = "<p><b>Time of Day: </b>" + markersOnMap[i].timeOfDay + "</p>"
                let dOrN = "<p><b>Day or Night: </b>" + markersOnMap[i].dayOrNight + "</p>"

                const marker = new google.maps.Marker({
                    position: markersOnMap[i].LatLng[0],
                    icon: icons[markersOnMap[i].type].icon,
                    map: map,
                });

                let infowindow = new google.maps.InfoWindow({
                    content: "<h6>Fire Information</h6>" + coords + date + time + dOrN,
                });

                marker.addListener("click", function() {
                   infowindow.open(map, marker)
                });
            }
        }

    </script>

    <!-- Wind API Scripts -->
    <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"></script>
    <script src="https://api.windy.com/assets/map-forecast/libBoot.js"></script>

    <script>
        const options = {
            // Required: API key
            key: "9QSfoEZ65tLoOiqM1Lkvx1t2JCZSvMtT",

            // Put additional console output
            verbose: true,

            // Optional: Initial state of the map
            lat: 15.0,
            lon: 100.0,
            zoom: 6.5
        };

        // Initialize Windy API
        windyInit(options, windyAPI => {
            // windyAPI is ready, and contain 'map', 'store',
            // 'picker' and other usefull stuff

            const {map} = windyAPI;
            // .map is instance of Leaflet map

            L.popup()
                .setLatLng([15.0, 101.0])
                .setContent("Welcome to Windy! You can use this window to check the weather and temperature in Thailand.")
                .openOn(map);
        });
    </script>

</head>


<body>
<nav class="mdb-navbar navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
        <a class="navbar-brand" href="Home">MaePing FirePA</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown"
                aria-controls="navbarNavDropdown" aria-haspopup="true" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="Home">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="LINE">LINE</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="Fire Timeline">Fire Timeline</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button"
                       data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Instructional Videos
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                        <li><a class="dropdown-item" href="Nasa FIRMS">Nasa FIRMS</a></li>
                        <li><a class="dropdown-item" href="CuSense">CuSense</a></li>
                        <li><a class="dropdown-item" href="Windy">Windy</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div id="Fire Timeline" class=" animated fadeInUp">
    <div class="container-sm" id="center">
        <h1 class="display-1">Fire Hotspot Timeline</h1>
    </div>
    <div id="map" class="centerr container"></div>
    <script
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA3KYwKVRO-jV0NFiGHlTc5qXuKlO9OT_w&callback=initMap&libraries=&v=weekly"
            async
    ></script>
    <p> Red Icons on the map indicate fires that are occuring during the day ธันวาคม</p>
    <p> Black Icons on the map indicate fires that are occuring during the day</p>
    <div id="windy" class="centerr"></div>
    <!-- place fire timeline in container div once finished or for testing -->
    <div class="container-fluid"></div>
</div>

<div id="Nasa FIRMS" style="visibility: hidden; display:none;" class=" animated fadeInUp">
    <h1 class="display-1"> Nasa FIRMS</h1>
    <p> This is a placeholder video </p>
    <div class="container-sm" class="centerr">
        <iframe width="560" height="315" class="embed-responsive-item" src="https://www.youtube.com/embed/FGgtwEQ-BTk"
                frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen></iframe>
    </div>

</div>

</body>

</html>